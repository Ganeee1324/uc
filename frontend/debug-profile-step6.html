<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Profile Step 6 - Multiple Hidden Components</title>
    <link rel="stylesheet" href="css/profile.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons&display=swap">
    
    <!-- Load search component first without defer -->
    <script src="components/search-section/search-section-component.js"></script>
</head>
<body data-page="dashboard">
    <!-- Mobile Menu Toggle Button -->
    <label class="hamburger" id="mobileMenuToggle">
        <input type="checkbox">
        <svg viewBox="0 0 32 32">
            <path class="line line-top-bottom" d="M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22"></path>
            <path class="line" d="M7 16 27 16"></path>
        </svg>
    </label>
    
    <!-- Mobile sidebar overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <div class="sidebar" id="sidebar">
        <!-- Sidebar content would go here -->
    </div>

    <div class="main-content">
        <!-- Profile Section (visible by default) -->
        <div class="profile-section">
            <h1>Debug Profile Step 6 - Multiple Hidden Components</h1>
            <p>Testing if multiple search components in hidden containers break initialization</p>
            
            <!-- Search Section Component - Main (visible) -->
            <div id="searchSectionContainer" style="margin-top: 20px; width: 100%; display: block;">
                <search-section-component 
                    api-base="https://symbia.it:5000"
                    placeholder-text="Cerca una dispensa..."
                    button-text="Cerca">
                </search-section-component>
            </div>
        </div>

        <!-- Documents Dashboard (hidden by default) -->
        <div id="documentsDashboard" style="display: none;">
            <h2>Documents Dashboard</h2>
            
            <!-- Search Section Component for Documents (hidden) -->
            <div id="documentsSearchSectionContainer">
                <search-section-component 
                    api-base="https://symbia.it:5000"
                    placeholder-text="Cerca i tuoi documenti..."
                    button-text="Cerca">
                </search-section-component>
            </div>
        </div>

        <!-- Favorites Dashboard (hidden by default) -->
        <div id="favoritesDashboard" style="display: none;">
            <h2>Favorites Dashboard</h2>
            
            <!-- Search Section Component for Favorites (hidden) -->
            <div id="favoritesSearchSectionContainer">
                <search-section-component 
                    api-base="https://symbia.it:5000"
                    placeholder-text="Cerca una dispensa..."
                    button-text="Cerca">
                </search-section-component>
            </div>
        </div>
    </div>

    <!-- Professional Performance & Caching System -->
    <script src="js/config.js" defer></script>
    <script src="js/performance-cache.js" defer></script>
    <script src="js/profile.js" defer></script>

    <script>
        // Test script loading
        console.log('=== DEBUG STEP 6: MULTIPLE HIDDEN COMPONENTS ===');
        console.log('1. Script loading test:');
        console.log('- search-section-component.js loaded:', typeof SearchSectionComponent !== 'undefined');
        console.log('- config.js loaded:', typeof window.APP_CONFIG !== 'undefined');
        console.log('- performance-cache.js loaded:', typeof window.performanceCache !== 'undefined');
        console.log('- profile.js loaded:', typeof window.switchTab !== 'undefined');
        
        // Test component registration
        console.log('2. Component registration test:');
        console.log('- Custom element defined:', customElements.get('search-section-component') !== undefined);
        
        // Test component initialization
        console.log('3. Component initialization test:');
        setTimeout(() => {
            const components = document.querySelectorAll('search-section-component');
            console.log(`Found ${components.length} search components`);
            
            components.forEach((component, index) => {
                const container = component.closest('[id]');
                const isVisible = container && window.getComputedStyle(container).display !== 'none';
                
                console.log(`Component ${index + 1}:`);
                console.log('- Found:', component !== null);
                console.log('- Container:', container?.id || 'no container');
                console.log('- Container visible:', isVisible);
                console.log('- Shadow root created:', component?.shadowRoot !== null);
                console.log('- Component initialized:', component?.shadowRoot?.innerHTML.includes('search') || false);
                
                // Test if search functionality works
                const searchInput = component?.shadowRoot?.querySelector('input[type="text"]');
                console.log('- Search input found:', searchInput !== null);
                
                if (searchInput) {
                    console.log(`✅ Component ${index + 1} is working!`);
                } else {
                    console.log(`❌ Component ${index + 1} is broken!`);
                }
            });
        }, 500);
    </script>
</body>
</html> 